worker_processes auto;
error_log /dev/stderr notice;
pid /usr/local/nginx/logs/nginx.pid;

events {
    worker_connections 4096; # default is 1024
}

http {
    server_names_hash_bucket_size 128;
    client_max_body_size 0;

    # http://nginx.org/en/docs/http/configuring_https_servers.html#optimization
    ssl_session_cache shared:SSL:50m;
    ssl_session_timeout 10m;
    access_log /dev/stdout;

    sendfile            off;
    tcp_nopush          on;
    tcp_nodelay         on;
    keepalive_timeout   70;
    keepalive_requests  100;
    types_hash_max_size 2048;
    output_buffers 2 1m;
    send_timeout 600;          # increase for slow clients / big files

    gzip              on;
    gzip_comp_level   2;
    gzip_http_version 1.1;
    gzip_proxied      any;
    gzip_min_length   1000;
    gzip_disable      "MSIE [1-6]\.";
    gzip_types        text/plain
                      text/xml
                      text/css
                      text/comma-separated-values
                      text/javascript
                      text/tab-separated-values
                      application/javascript
                      application/json
                      application/x-javascript
                      application/atom+xml;

    include             /usr/local/nginx/conf/mime.types;
    default_type        application/octet-stream;

    proxy_http_version 1.1;
    proxy_set_header Connection "";
    proxy_cache_path /var/cache/nginx levels=1:2 keys_zone=one:10m max_size=10g inactive=10m use_temp_path=off;

    server_tokens off;

    server {
        listen 8082;
        resolver 127.0.0.11;
        server_name localhost 127.0.0.1;

        location /tests {
            alias /tests/;   # trailing slash important
            autoindex on;
        }
    }
}
